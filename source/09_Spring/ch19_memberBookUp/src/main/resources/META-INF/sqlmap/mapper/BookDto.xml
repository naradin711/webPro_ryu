<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    <mapper namespace="com.lec.ch19.dao.BookDao">
    	<resultMap type="BookDto" id="book">
    		<result property="bnum" column="bnum"/>
    		<result property="btitle" column="btitle"/>
    		<result property="bwriter" column="bwriter"/>
    		<result property="brdate" column="brdate"/>
    		<result property="bimg1" column="bimg1"/>
    		<result property="bimg2" column="bimg2"/>
    		<result property="binfo" column="binfo"/> 
    	</resultMap>
    	
    	<select id="mainList" parameterType="BookDto" resultMap="book">
    		<![CDATA[
    			
    			SELECT * FROM BOOK ORDER BY BRDATE DESC
    		
    		]]>
    	</select> 
    	<select id="bookList" parameterType="BookDto" resultMap="book">
    		SELECT * FROM
    		(SELECT ROWNUM RN, A.* FROM
    		(SELECT * FROM BOOK ORDER BY btitle)A )
    		WHERE RN BETWEEN #{startRow} AND #{endRow}
    	</select>
    	<select id="totCntBook" resultType="int">
    		select count(*) cnt from book
    	</select>
    	<select id="getDetailBook" parameterType="int" resultType="BookDto">
    		select * from book where bnum = #{bnum}
    	</select> 
    	
    	<insert id="registerBook" parameterType="BookDto">
    		INSERT INTO BOOK VALUES
			(BOOK_SQ.NEXTVAL, #{btitle}, #{bwriter},
			sysdate,  #{bimg1}, #{bimg2}, #{binfo})
    	</insert>
    	<update id="modifyBook" parameterType="BookDto">
    		update book set btitle = #{btitle} ,
                bwriter = #{bwriter},
                bimg1 = #{bimg1},
                bimg2 = #{bimg2} ,
                binfo = #{binfo}
                where bnum = #{btitle}
    	</update>
    
    </mapper>